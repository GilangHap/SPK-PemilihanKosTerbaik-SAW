<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPK Pemilihan Kos Terbaik</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/heroicons@2.0.16/outline/index.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-blue-50" x-data="spkApp()">
    <!-- Header -->
    <header class="bg-blue-800 text-white shadow-lg">
        <div class="container mx-auto p-4 md:p-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold">Sistem Pendukung Keputusan</h1>
                    <p class="text-blue-200">Pemilihan Kos Terbaik di Sekitar Kampus</p>
                </div>
                <div class="mt-3 md:mt-0">
                    <span class="bg-blue-700 px-3 py-1 rounded-full text-sm">Metode SAW</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 md:p-6">
        <!-- Navigation Tabs -->
        <div class="flex flex-wrap border-b border-gray-200 mb-6">
            <button @click="activeTab = 'input'" :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'input', 'text-gray-500': activeTab !== 'input'}" class="px-4 py-2 font-medium">
                Input Data
            </button>
            <button @click="activeTab = 'calculation'" :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'calculation', 'text-gray-500': activeTab !== 'calculation'}" class="px-4 py-2 font-medium">
                Proses Perhitungan
            </button>
            <button @click="activeTab = 'result'" :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'result', 'text-gray-500': activeTab !== 'result'}" class="px-4 py-2 font-medium">
                Hasil Rekomendasi
            </button>
            <button @click="activeTab = 'about'" :class="{'border-b-2 border-blue-500 text-blue-600': activeTab === 'about', 'text-gray-500': activeTab !== 'about'}" class="px-4 py-2 font-medium">
                Tentang Metode
            </button>
        </div>

        <!-- Input Tab -->
        <div x-show="activeTab === 'input'" x-cloak>
            <div class="flex flex-col md:flex-row gap-6">
                <!-- Input Form -->
                <div class="w-full md:w-1/2 bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4">Tambah Data Kos</h2>
                    <form @submit.prevent="addBoardingHouse">
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
                                Nama Kos
                            </label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                                   id="name" type="text" x-model="newBoardingHouse.name" required>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Fasilitas (C1) - Bobot: 5
                            </label>
                            <div class="flex items-center">
                                <template x-for="i in 5">
                                    <div class="mr-4">
                                        <input type="radio" :id="'c1_'+i" name="c1" :value="i" x-model="newBoardingHouse.criteria.c1" class="mr-1" required>
                                        <label :for="'c1_'+i" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Harga Sewa (C2) - Bobot: 4
                            </label>
                            <div class="flex items-center">
                                <template x-for="i in 5">
                                    <div class="mr-4">
                                        <input type="radio" :id="'c2_'+i" name="c2" :value="i" x-model="newBoardingHouse.criteria.c2" class="mr-1" required>
                                        <label :for="'c2_'+i" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Keamanan (C3) - Bobot: 3
                            </label>
                            <div class="flex items-center">
                                <template x-for="i in 5">
                                    <div class="mr-4">
                                        <input type="radio" :id="'c3_'+i" name="c3" :value="i" x-model="newBoardingHouse.criteria.c3" class="mr-1" required>
                                        <label :for="'c3_'+i" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Kebersihan (C4) - Bobot: 2
                            </label>
                            <div class="flex items-center">
                                <template x-for="i in 5">
                                    <div class="mr-4">
                                        <input type="radio" :id="'c4_'+i" name="c4" :value="i" x-model="newBoardingHouse.criteria.c4" class="mr-1" required>
                                        <label :for="'c4_'+i" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">
                                Jarak ke Kampus (C5) - Bobot: 1
                            </label>
                            <div class="flex items-center">
                                <template x-for="i in 5">
                                    <div class="mr-4">
                                        <input type="radio" :id="'c5_'+i" name="c5" :value="i" x-model="newBoardingHouse.criteria.c5" class="mr-1" required>
                                        <label :for="'c5_'+i" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="flex items-center justify-between">
                            <button class="bg-blue-800 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" 
                                   type="submit">
                                Tambah Data
                            </button>
                            <button class="bg-gray-500 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" 
                                   type="reset" @click="resetForm">
                                Reset
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Data Table -->
                <div class="w-full md:w-1/2 bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">Data Kos</h2>
                        <div>
                            <button @click="loadDefaultData" class="bg-green-600 hover:bg-green-500 text-white py-1 px-3 rounded text-sm">
                                Load Default Data
                            </button>
                            <button @click="boardingHouses = []" class="bg-red-600 hover:bg-red-500 text-white py-1 px-3 rounded text-sm ml-2">
                                Clear All
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Nama</th>
                                    <th class="py-2 px-2 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C1</th>
                                    <th class="py-2 px-2 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C2</th>
                                    <th class="py-2 px-2 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C3</th>
                                    <th class="py-2 px-2 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C4</th>
                                    <th class="py-2 px-2 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C5</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-if="boardingHouses.length === 0">
                                    <tr>
                                        <td colspan="7" class="py-4 px-6 border-b border-gray-200 text-center text-gray-500">
                                            Belum ada data. Silakan input data atau load default data.
                                        </td>
                                    </tr>
                                </template>
                                <template x-for="(house, index) in boardingHouses" :key="index">
                                    <tr>
                                        <td class="py-2 px-4 border-b border-gray-200" x-text="house.name"></td>
                                        <td class="py-2 px-2 border-b border-gray-200 text-center" x-text="house.criteria.c1"></td>
                                        <td class="py-2 px-2 border-b border-gray-200 text-center" x-text="house.criteria.c2"></td>
                                        <td class="py-2 px-2 border-b border-gray-200 text-center" x-text="house.criteria.c3"></td>
                                        <td class="py-2 px-2 border-b border-gray-200 text-center" x-text="house.criteria.c4"></td>
                                        <td class="py-2 px-2 border-b border-gray-200 text-center" x-text="house.criteria.c5"></td>
                                        <td class="py-2 px-4 border-b border-gray-200 text-center">
                                            <button @click="deleteBoardingHouse(index)" class="text-red-600 hover:text-red-800">
                                                Hapus
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-4 text-right">
                        <button @click="if(boardingHouses.length > 0) { calculateSAW(); activeTab = 'calculation'; }" 
                                class="bg-blue-800 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                                :disabled="boardingHouses.length === 0"
                                :class="{'opacity-50 cursor-not-allowed': boardingHouses.length === 0}">
                            Proses Perhitungan
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculation Tab -->
        <div x-show="activeTab === 'calculation'" x-cloak>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Matriks Keputusan</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4">
                        <thead>
                            <tr>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Alternatif</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C1 (Benefit)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C2 (COST)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C3 (Benefit)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C4 (COST)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C5 (Benefit)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in boardingHouses" :key="index">
                                <tr>
                                    <td class="py-2 px-4 border-b border-gray-200" x-text="house.name"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.criteria.c1"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.criteria.c2"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.criteria.c3"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.criteria.c4"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.criteria.c5"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Matriks Ternormalisasi</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4">
                        <thead>
                            <tr>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Alternatif</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C1 (Benefit)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C2 (Cost)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C3 (Benefit)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C4 (Benefit)</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C5 (Cost)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in normalizedData" :key="index">
                                <tr>
                                    <td class="py-2 px-4 border-b border-gray-200" x-text="house.name"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.normalized.c1.toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.normalized.c2.toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.normalized.c3.toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.normalized.c4.toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="house.normalized.c5.toFixed(4)"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Perhitungan Nilai Preferensi</h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4">
                        <thead>
                            <tr>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Alternatif</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C1 × 5</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C2 × 4</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C3 × 3</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C4 × 2</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">C5 × 1</th>
                                <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in finalResults" :key="index">
                                <tr>
                                    <td class="py-2 px-4 border-b border-gray-200" x-text="house.name"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="(house.weightedValues.c1).toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="(house.weightedValues.c2).toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="(house.weightedValues.c3).toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="(house.weightedValues.c4).toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center" x-text="(house.weightedValues.c5).toFixed(4)"></td>
                                    <td class="py-2 px-4 border-b border-gray-200 text-center font-bold" x-text="house.totalScore.toFixed(4)"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-4 text-right">
                    <button @click="activeTab = 'result'" 
                            class="bg-blue-800 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Lihat Hasil Akhir
                    </button>
                </div>
            </div>
        </div>

        <!-- Result Tab -->
        <div x-show="activeTab === 'result'" x-cloak>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Final Ranking -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">Hasil Akhir Perangkingan</h2>
                        <div>
                            <button @click="exportToPDF()" class="bg-red-600 hover:bg-red-500 text-white py-1 px-3 rounded text-sm">
                                Export PDF
                            </button>
                            <button @click="exportToExcel()" class="bg-green-600 hover:bg-green-500 text-white py-1 px-3 rounded text-sm ml-2">
                                Export Excel
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white" id="resultTable">
                            <thead>
                                <tr>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Ranking</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase">Nama Kos</th>
                                    <th class="py-2 px-4 border-b border-gray-200 bg-gray-100 text-center text-xs font-semibold text-gray-600 uppercase">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="(house, index) in finalRanking" :key="index">
                                    <tr :class="{'bg-blue-100': index === 0}">
                                        <td class="py-3 px-4 border-b border-gray-200" x-text="index + 1"></td>
                                        <td class="py-3 px-4 border-b border-gray-200 font-medium" x-text="house.name"></td>
                                        <td class="py-3 px-4 border-b border-gray-200 text-center font-bold" x-text="house.totalScore.toFixed(4)"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chart Visualization -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4">Visualisasi Hasil</h2>
                    <canvas id="resultChart" width="400" height="300"></canvas>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Perbandingan Kriteria</h2>
                <canvas id="criteriaChart" width="400" height="200"></canvas>
            </div>

            <div class="text-center p-4">
                <a href="#" @click.prevent="activeTab = 'input'" class="text-blue-600 hover:underline font-medium">
                    Kembali ke Input Data
                </a>
            </div>
        </div>

        <!-- About Tab -->
        <div x-show="activeTab === 'about'" x-cloak>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Tentang Metode SAW</h2>
                <div class="prose max-w-none">
                    <p>Metode Simple Additive Weighting (SAW) adalah salah satu metode dalam Sistem Pendukung Keputusan (SPK) yang digunakan untuk menentukan alternatif terbaik dari beberapa alternatif berdasarkan kriteria tertentu.</p>
                    
                    <h3 class="font-bold mt-4">Langkah-langkah Metode SAW:</h3>
                    <ol class="list-decimal list-inside">
                        <li class="mb-2">
                            <span class="font-semibold">Menentukan kriteria</span> yang akan digunakan sebagai acuan pengambilan keputusan.
                        </li>
                        <li class="mb-2">
                            <span class="font-semibold">Menentukan bobot</span> untuk masing-masing kriteria.
                        </li>
                        <li class="mb-2">
                            <span class="font-semibold">Membuat matriks keputusan</span> berdasarkan kriteria.
                        </li>
                        <li class="mb-2">
                            <span class="font-semibold">Melakukan normalisasi matriks</span> berdasarkan jenis atribut (benefit atau cost).
                            <ul class="list-disc list-inside ml-5">
                                <li>Untuk atribut benefit: <code>r<sub>ij</sub> = x<sub>ij</sub> / max(x<sub>ij</sub>)</code></li>
                                <li>Untuk atribut cost: <code>r<sub>ij</sub> = min(x<sub>ij</sub>) / x<sub>ij</sub></code></li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <span class="font-semibold">Menghitung nilai preferensi</span> untuk setiap alternatif dengan mengalikan nilai ternormalisasi dengan bobot kriteria kemudian menjumlahkannya.
                        </li>
                        <li class="mb-2">
                            <span class="font-semibold">Mengurutkan alternatif</span> berdasarkan nilai preferensi dari tertinggi ke terendah untuk mendapatkan alternatif terbaik.
                        </li>
                    </ol>
                    
                    <h3 class="font-bold mt-4">Kriteria dan Bobot yang Digunakan:</h3>
                    <table class="min-w-full bg-white border mt-2">
                        <thead>
                            <tr>
                                <th class="py-2 px-4 border text-left">Kriteria</th>
                                <th class="py-2 px-4 border text-center">Bobot</th>
                                <th class="py-2 px-4 border text-center">Jenis</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="py-2 px-4 border">Fasilitas (C1)</td>
                                <td class="py-2 px-4 border text-center">5</td>
                                <td class="py-2 px-4 border text-center">Benefit</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 border">Harga Sewa (C2)</td>
                                <td class="py-2 px-4 border text-center">4</td>
                                <td class="py-2 px-4 border text-center">Cost</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 border">Keamanan (C3)</td>
                                <td class="py-2 px-4 border text-center">3</td>
                                <td class="py-2 px-4 border text-center">Benefit</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 border">Kebersihan (C4)</td>
                                <td class="py-2 px-4 border text-center">2</td>
                                <td class="py-2 px-4 border text-center">Benefit</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 border">Jarak ke Kampus (C5)</td>
                                <td class="py-2 px-4 border text-center">1</td>
                                <td class="py-2 px-4 border text-center">Cost</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <p class="mt-4">
                        <strong>Catatan:</strong> Untuk kriteria jenis benefit, semakin tinggi nilainya semakin baik. Untuk kriteria jenis cost, semakin rendah nilainya semakin baik.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-blue-800 text-white py-4 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p>Sistem Pendukung Keputusan Pemilihan Kos Terbaik di Sekitar Kampus</p>
            <p class="text-blue-200 text-sm mt-1">© 2025 - Metode Simple Additive Weighting (SAW)</p>
        </div>
    </footer>

    <!-- Script -->
    <script>
        function spkApp() {
            return {
                activeTab: 'input',
                boardingHouses: [],
                normalizedData: [],
                finalResults: [],
                finalRanking: [],
                resultChart: null,
                criteriaChart: null,
                
                // Weights for each criteria
                weights: {
                    c1: 5, // Facility (Benefit)
                    c2: 4, // Rent Price (Cost)
                    c3: 3, // Security (Benefit)
                    c4: 2, // Cleanliness (Benefit)
                    c5: 1  // Distance to Campus (Cost)
                },

                // New boarding house template
                newBoardingHouse: {
                    name: '',
                    criteria: {
                        c1: '',
                        c2: '',
                        c3: '',
                        c4: '',
                        c5: ''
                    }
                },

                // Initialize the app
                init() {
                    // Load data from localStorage if exists
                    const savedData = localStorage.getItem('boardingHouses');
                    if (savedData) {
                        this.boardingHouses = JSON.parse(savedData);
                    }

                    // Watch for changes to save in localStorage
                    this.$watch('boardingHouses', (value) => {
                        localStorage.setItem('boardingHouses', JSON.stringify(value));
                    });
                },

                // Add new boarding house
                addBoardingHouse() {
                    this.boardingHouses.push({
                        name: this.newBoardingHouse.name,
                        criteria: {
                            c1: parseInt(this.newBoardingHouse.criteria.c1),
                            c2: parseInt(this.newBoardingHouse.criteria.c2),
                            c3: parseInt(this.newBoardingHouse.criteria.c3),
                            c4: parseInt(this.newBoardingHouse.criteria.c4),
                            c5: parseInt(this.newBoardingHouse.criteria.c5)
                        }
                    });
                    this.resetForm();
                },

                // Delete boarding house
                deleteBoardingHouse(index) {
                    this.boardingHouses.splice(index, 1);
                },

                // Reset form
                resetForm() {
                    this.newBoardingHouse = {
                        name: '',
                        criteria: {
                            c1: '',
                            c2: '',
                            c3: '',
                            c4: '',
                            c5: ''
                        }
                    };
                },

                // Load default data
                loadDefaultData() {
                    this.boardingHouses = [
                        {
                            name: "Wisma Soedirman",
                            criteria: { c1: 5, c2: 4, c3: 4, c4: 3, c5: 2 }
                        },
                        {
                            name: "Wisma Boy",
                            criteria: { c1: 4, c2: 3, c3: 5, c4: 4, c5: 3 }
                        },
                        {
                            name: "Kos Eka",
                            criteria: { c1: 3, c2: 2, c3: 3, c4: 4, c5: 4 }
                        },
                        {
                            name: "Krikil Kos",
                            criteria: { c1: 4, c2: 3, c3: 3, c4: 5, c5: 2 }
                        },
                        {
                            name: "Kos Yolanda",
                            criteria: { c1: 5, c2: 5, c3: 4, c4: 3, c5: 1 }
                        }
                    ];
                },

                // Calculate using SAW method
                calculateSAW() {
                    // Find max values for each criteria (all are now benefit)
                    let maxC1 = Math.max(...this.boardingHouses.map(h => h.criteria.c1));
                    let maxC2 = Math.max(...this.boardingHouses.map(h => h.criteria.c2));
                    let maxC3 = Math.max(...this.boardingHouses.map(h => h.criteria.c3));
                    let maxC4 = Math.max(...this.boardingHouses.map(h => h.criteria.c4));
                    let maxC5 = Math.max(...this.boardingHouses.map(h => h.criteria.c5));

                    // Calculate normalized matrix
                    this.normalizedData = this.boardingHouses.map(house => {
                        return {
                            name: house.name,
                            normalized: {
                                // For benefit criteria: value / max
                                c1: house.criteria.c1 / maxC1,
                                c2: house.criteria.c2 / maxC2, // Changed from cost to benefit
                                c3: house.criteria.c3 / maxC3,
                                c4: house.criteria.c4 / maxC4,
                                c5: house.criteria.c5 / maxC5, // Changed from cost to benefit
                            }
                        };
                    });

                    // Calculate weighted values and final score
                    this.finalResults = this.normalizedData.map(house => {
                        const weightedValues = {
                            c1: house.normalized.c1 * this.weights.c1,
                            c2: house.normalized.c2 * this.weights.c2,
                            c3: house.normalized.c3 * this.weights.c3,
                            c4: house.normalized.c4 * this.weights.c4,
                            c5: house.normalized.c5 * this.weights.c5
                        };
                        
                        const totalScore = weightedValues.c1 + weightedValues.c2 + weightedValues.c3 + weightedValues.c4 + weightedValues.c5;
                        
                        return {
                            name: house.name,
                            weightedValues: weightedValues,
                            totalScore: totalScore
                        };
                    });

                    // Sort by total score (descending)
                    this.finalRanking = [...this.finalResults].sort((a, b) => b.totalScore - a.totalScore);

                    // Wait for DOM update then create charts
                    this.$nextTick(() => {
                        this.createResultChart();
                        this.createCriteriaChart();
                    });
                },

                // Create bar chart for results
                createResultChart() {
                    const ctx = document.getElementById('resultChart');
                    
                    // Destroy existing chart if it exists
                    if (this.resultChart) {
                        this.resultChart.destroy();
                    }
                    
                    // Create new chart
                    this.resultChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: this.finalRanking.map(house => house.name),
                            datasets: [{
                                label: 'Skor Akhir',
                                data: this.finalRanking.map(house => house.totalScore),
                                backgroundColor: [
                                    'rgba(30, 64, 175, 0.8)',
                                    'rgba(37, 99, 235, 0.7)',
                                    'rgba(59, 130, 246, 0.6)',
                                    'rgba(96, 165, 250, 0.5)',
                                    'rgba(147, 197, 253, 0.4)'
                                ],
                                borderColor: [
                                    'rgba(30, 64, 175, 1)',
                                    'rgba(37, 99, 235, 1)',
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(96, 165, 250, 1)',
                                    'rgba(147, 197, 253, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 15
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: true,
                                    text: 'Peringkat Kos Berdasarkan Skor SAW'
                                }
                            }
                        }
                    });
                },

                // Create pie chart for criteria weights
                createCriteriaChart() {
                    const ctx = document.getElementById('criteriaChart');
                    
                    // Destroy existing chart if it exists
                    if (this.criteriaChart) {
                        this.criteriaChart.destroy();
                    }
                    
                    // Create new chart
                    this.criteriaChart = new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: ['Fasilitas (C1)', 'Harga Sewa (C2)', 'Keamanan (C3)', 'Kebersihan (C4)', 'Jarak ke Kampus (C5)'],
                            datasets: [{
                                data: [
                                    this.weights.c1,
                                    this.weights.c2,
                                    this.weights.c3,
                                    this.weights.c4,
                                    this.weights.c5
                                ],
                                backgroundColor: [
                                    'rgba(30, 64, 175, 0.8)',
                                    'rgba(37, 99, 235, 0.7)',
                                    'rgba(59, 130, 246, 0.6)',
                                    'rgba(96, 165, 250, 0.5)',
                                    'rgba(147, 197, 253, 0.4)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Bobot Kriteria'
                                }
                            }
                        }
                    });
                },

                // Export to PDF
                exportToPDF() {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    doc.setFontSize(16);
                    doc.text("Hasil SPK Pemilihan Kos Terbaik", 14, 15);
                    doc.setFontSize(12);
                    doc.text("Metode: Simple Additive Weighting (SAW)", 14, 25);
                    
                    // Create data for the table
                    const tableData = this.finalRanking.map((house, index) => [
                        index + 1,
                        house.name,
                        house.totalScore.toFixed(4)
                    ]);
                    
                    // Add table headers
                    const headers = [["Ranking", "Nama Kos", "Skor"]];
                    
                    // Add the table
                    doc.autoTable({
                        startY: 35,
                        head: headers,
                        body: tableData,
                        theme: 'grid',
                        headStyles: {
                            fillColor: [30, 64, 175],
                            textColor: 255
                        }
                    });
                    
                    // Add footer
                    const pageCount = doc.internal.getNumberOfPages();
                    for (let i = 1; i <= pageCount; i++) {
                        doc.setPage(i);
                        doc.setFontSize(10);
                        doc.text(`Dicetak pada: ${new Date().toLocaleString()}`, 14, doc.internal.pageSize.height - 10);
                    }
                    
                    // Save the PDF
                    doc.save("spk-boarding-house-result.pdf");
                },

                // Export to Excel
                exportToExcel() {
                    // Create Excel-like CSV data
                    let csvContent = "data:text/csv;charset=utf-8,";
                    
                    // Add headers
                    csvContent += "Ranking,Nama Kos,Skor\n";
                    
                    // Add data rows
                    this.finalRanking.forEach((house, index) => {
                        csvContent += `${index + 1},${house.name},${house.totalScore.toFixed(4)}\n`;
                    });
                    
                    // Create a download link
                    const encodedUri = encodeURI(csvContent);
                    const link = document.createElement("a");
                    link.setAttribute("href", encodedUri);
                    link.setAttribute("download", "spk-boarding-house-result.csv");
                    document.body.appendChild(link);
                    
                    // Trigger the download
                    link.click();
                    document.body.removeChild(link);
                }
            };
        }
    </script>
</body>
</html>