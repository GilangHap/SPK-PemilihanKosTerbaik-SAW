<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPK Pemilihan Kos Terbaik</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/heroicons@2.0.16/outline/index.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
    <style>
        [x-cloak] { display: none !important; }
        body {
            font-family: 'Poppins', sans-serif;
        }
        .comparison-table {
        width: 100%;
        max-width: 100%;
        table-layout: fixed;
        }

        /* If they are card elements */
        .criteria-comparison {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: space-between;
        }

        .criteria-item {
        flex: 1 1 300px;
        max-width: 100%;
        overflow: hidden;
        }

        /* For any oversized elements */
        .criteria-content {
        overflow: auto;
        max-height: 500px; /* Adjust as needed */
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
        .criteria-item {
            flex: 1 1 100%;
        }
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .tab-active {
            position: relative;
        }
        .tab-active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 3px 3px 0 0;
        }
        .rating-container {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
        }
        .rating-container input {
            display: none;
        }
        .rating-container label {
            cursor: pointer;
            width: 25px;
            height: 25px;
            background: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 5px;
            margin: 0 3px;
            transition: all 0.2s ease;
        }
        .rating-container label:hover,
        .rating-container label:hover ~ label,
        .rating-container input:checked ~ label {
            background: #667eea;
            color: white;
        }
        .btn-primary {
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .hover-card {
            transition: all 0.3s ease;
        }
        .hover-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .backdrop {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.08'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
                .export-btn {
            position: relative;
            overflow: hidden;
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .export-btn:active {
            transform: translateY(0);
        }
        
        .export-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .export-btn:hover::before {
            left: 100%;
        }
        
        .btn-icon {
            transition: transform 0.3s ease;
        }
        
        .export-btn:hover .btn-icon {
            transform: scale(1.1);
        }
        
        .pdf-gradient {
            background: linear-gradient(135deg, #f43f5e, #ec4899);
        }
        
        .excel-gradient {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .load-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }
        
        .load-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .load-gradient:hover::before {
            left: 100%;
        }
        
        .clear-gradient {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            position: relative;
            overflow: hidden;
        }
        
        .clear-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .clear-gradient:hover::before {
            left: 100%;
        }
        
        .btn-enhanced {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
        }
        
        .btn-enhanced:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .btn-enhanced:active {
            transform: translateY(0);
        }
        
        .btn-icon {
            transition: transform 0.3s ease;
        }
        
        .btn-enhanced:hover .btn-icon {
            transform: scale(1.1);
        }
        
        .ripple {
            position: relative;
            overflow: hidden;
        }
        
        .ripple::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .ripple:active::after {
            width: 300px;
            height: 300px;
        }
        
        .glow-effect {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .glow-effect-red {
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
        }
        
        .load-gradient:hover {
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
        }
        
        .clear-gradient:hover {
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
        }

    </style>
</head>
<body class="backdrop bg-gray-50" x-data="spkApp()">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-xl">
        <div class="container mx-auto p-4 md:p-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="animate__animated animate__fadeInLeft">
                    <h1 class="text-2xl md:text-3xl font-bold">Sistem Pendukung Keputusan</h1>
                    <p class="text-indigo-100">Pemilihan Kos Terbaik di Sekitar Kampus</p>
                </div>
                <div class="mt-3 md:mt-0 animate__animated animate__fadeInRight">
                    <span class="bg-white bg-opacity-20 backdrop-filter backdrop-blur-sm px-4 py-2 rounded-full text-sm font-medium shadow-md">
                        <i class="fas fa-chart-line mr-1"></i> Metode SAW
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 md:p-6">
        <!-- Navigation Tabs -->
        <div class="flex flex-wrap mb-6 bg-white rounded-full shadow-md p-1 overflow-x-auto">
            <button @click="activeTab = 'input'" :class="{'tab-active text-indigo-600 font-semibold': activeTab === 'input', 'text-gray-600': activeTab !== 'input'}" 
                class="px-5 py-2 rounded-full transition duration-200 ease-in-out hover:bg-indigo-50">
                <i class="fas fa-keyboard mr-1"></i> Input Data
            </button>
            <button @click="activeTab = 'calculation'" :class="{'tab-active text-indigo-600 font-semibold': activeTab === 'calculation', 'text-gray-600': activeTab !== 'calculation'}" 
                class="px-5 py-2 rounded-full transition duration-200 ease-in-out hover:bg-indigo-50">
                <i class="fas fa-calculator mr-1"></i> Proses Perhitungan
            </button>
            <button @click="activeTab = 'result'" :class="{'tab-active text-indigo-600 font-semibold': activeTab === 'result', 'text-gray-600': activeTab !== 'result'}" 
                class="px-5 py-2 rounded-full transition duration-200 ease-in-out hover:bg-indigo-50">
                <i class="fas fa-trophy mr-1"></i> Hasil Rekomendasi
            </button>
            <button @click="activeTab = 'about'" :class="{'tab-active text-indigo-600 font-semibold': activeTab === 'about', 'text-gray-600': activeTab !== 'about'}" 
                class="px-5 py-2 rounded-full transition duration-200 ease-in-out hover:bg-indigo-50">
                <i class="fas fa-info-circle mr-1"></i> Tentang Metode
            </button>
        </div>

        <!-- Input Tab -->
        <div x-show="activeTab === 'input'" x-cloak class="animate__animated animate__fadeIn">
            <div class="flex flex-col md:flex-row gap-6">
                <!-- Input Form -->
                <div class="w-full md:w-1/2 glass-card p-6">
                    <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                        <i class="fas fa-home text-indigo-600 mr-2"></i> Tambah Data Kos
                    </h2>
                    <form @submit.prevent="addBoardingHouse" class="space-y-4">
                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2" for="name">
                                Nama Kos
                            </label>
                            <div class="mt-1 relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="fas fa-building text-gray-400"></i>
                                </div>
                                <input class="border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-3 py-2 rounded-lg transition duration-200 ease-in-out" 
                                    id="name" type="text" x-model="newBoardingHouse.name" required placeholder="Masukkan nama kos">
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2">
                                <div class="flex items-center justify-between">
                                    <span>Fasilitas (C1)</span>
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Bobot: 5</span>
                                </div>
                            </label>
                            <div class="rating-container mb-1">
                                <template x-for="i in 5">
                                    <div>
                                        <input type="radio" :id="'c1_'+i" name="c1" :value="i" x-model="newBoardingHouse.criteria.c1" required>
                                        <label :for="'c1_'+i" class="flex items-center justify-center font-medium" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2">
                                <div class="flex items-center justify-between">
                                    <span>Harga Sewa (C2)</span>
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Bobot: 4</span>
                                </div>
                            </label>
                            <div class="rating-container mb-1">
                                <template x-for="i in 5">
                                    <div>
                                        <input type="radio" :id="'c2_'+i" name="c2" :value="i" x-model="newBoardingHouse.criteria.c2" required>
                                        <label :for="'c2_'+i" class="flex items-center justify-center font-medium" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2">
                                <div class="flex items-center justify-between">
                                    <span>Keamanan (C3)</span>
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Bobot: 3</span>
                                </div>
                            </label>
                            <div class="rating-container mb-1">
                                <template x-for="i in 5">
                                    <div>
                                        <input type="radio" :id="'c3_'+i" name="c3" :value="i" x-model="newBoardingHouse.criteria.c3" required>
                                        <label :for="'c3_'+i" class="flex items-center justify-center font-medium" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2">
                                <div class="flex items-center justify-between">
                                    <span>Kebersihan (C4)</span>
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Bobot: 2</span>
                                </div>
                            </label>
                            <div class="rating-container mb-1">
                                <template x-for="i in 5">
                                    <div>
                                        <input type="radio" :id="'c4_'+i" name="c4" :value="i" x-model="newBoardingHouse.criteria.c4" required>
                                        <label :for="'c4_'+i" class="flex items-center justify-center font-medium" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-2">
                                <div class="flex items-center justify-between">
                                    <span>Jarak ke Kampus (C5)</span>
                                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">Bobot: 1</span>
                                </div>
                            </label>
                            <div class="rating-container mb-1">
                                <template x-for="i in 5">
                                    <div>
                                        <input type="radio" :id="'c5_'+i" name="c5" :value="i" x-model="newBoardingHouse.criteria.c5" required>
                                        <label :for="'c5_'+i" class="flex items-center justify-center font-medium" x-text="i"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="flex items-center justify-between pt-2">
                            <button class="btn-primary text-white font-medium py-2 px-5 rounded-full focus:outline-none focus:shadow-outline shadow-lg" 
                                   type="submit">
                                <i class="fas fa-plus mr-1"></i> Tambah Data
                            </button>
                            <button class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-5 rounded-full focus:outline-none focus:shadow-outline transition duration-200" 
                                   type="reset" @click="resetForm">
                                <i class="fas fa-redo mr-1"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Data Table -->
                <div class="w-full md:w-1/2 glass-card p-6">
                    <div class="flex justify-between items-center mb-5">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-table text-indigo-600 mr-2"></i> Data Kos
                        </h2>
                        <div class="flex flex-wrap gap-4">
                            <button @click="loadDefaultData" class="btn-enhanced backdrop-blur-md load-gradient text-white py-3 px-6 rounded-xl text-sm font-semibold shadow-lg border border-white/20 flex items-center gap-2 ripple">
                                <i class="fas fa-database btn-icon"></i> 
                                <span>Load Default</span>
                            </button>
                            <button @click="boardingHouses = []" class="btn-enhanced backdrop-blur-md clear-gradient text-white py-3 px-6 rounded-xl text-sm font-semibold shadow-lg border border-white/20 flex items-center gap-2 ripple">
                                <i class="fas fa-trash btn-icon"></i> 
                                <span>Clear All</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full bg-white rounded-lg overflow-hidden">
                            <thead>
                                <tr class="gradient-bg text-white">
                                    <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Nama</th>
                                    <th class="py-3 px-2 text-center text-xs font-semibold uppercase tracking-wider">C1</th>
                                    <th class="py-3 px-2 text-center text-xs font-semibold uppercase tracking-wider">C2</th>
                                    <th class="py-3 px-2 text-center text-xs font-semibold uppercase tracking-wider">C3</th>
                                    <th class="py-3 px-2 text-center text-xs font-semibold uppercase tracking-wider">C4</th>
                                    <th class="py-3 px-2 text-center text-xs font-semibold uppercase tracking-wider">C5</th>
                                    <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-if="boardingHouses.length === 0">
                                    <tr>
                                        <td colspan="7" class="py-8 px-6 text-center text-gray-500">
                                            <div class="flex flex-col items-center">
                                                <i class="fas fa-database text-3xl text-gray-300 mb-2"></i>
                                                <p>Belum ada data. Silakan input data atau load default data.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                                <template x-for="(house, index) in boardingHouses" :key="index">
                                    <tr class="hover:bg-gray-50 transition duration-150">
                                        <td class="py-3 px-4 border-b" x-text="house.name"></td>
                                        <td class="py-3 px-2 border-b text-center" x-text="house.criteria.c1"></td>
                                        <td class="py-3 px-2 border-b text-center" x-text="house.criteria.c2"></td>
                                        <td class="py-3 px-2 border-b text-center" x-text="house.criteria.c3"></td>
                                        <td class="py-3 px-2 border-b text-center" x-text="house.criteria.c4"></td>
                                        <td class="py-3 px-2 border-b text-center" x-text="house.criteria.c5"></td>
                                        <td class="py-3 px-4 border-b text-center">
                                            <button @click="deleteBoardingHouse(index)" class="text-rose-500 hover:text-rose-700 transition duration-150">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-5 text-right">
                        <button @click="if(boardingHouses.length > 0) { calculateSAW(); activeTab = 'calculation'; }" 
                                class="btn-primary text-white font-medium py-2 px-5 rounded-full focus:outline-none focus:shadow-outline shadow-lg flex items-center ml-auto"
                                :disabled="boardingHouses.length === 0"
                                :class="{'opacity-50 cursor-not-allowed': boardingHouses.length === 0}">
                            <i class="fas fa-calculator mr-2"></i> Proses Perhitungan
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculation Tab -->
        <div x-show="activeTab === 'calculation'" x-cloak class="animate__animated animate__fadeIn">
            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                    <i class="fas fa-table text-indigo-600 mr-2"></i> Matriks Keputusan
                </h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4 rounded-lg overflow-hidden shadow">
                        <thead>
                            <tr class="gradient-bg text-white">
                                <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Alternatif</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C1 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C2 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C3 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C4 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C5 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in boardingHouses" :key="index">
                                <tr class="hover:bg-gray-50 transition duration-150">
                                    <td class="py-3 px-4 border-b font-medium" x-text="house.name"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.criteria.c1"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.criteria.c2"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.criteria.c3"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.criteria.c4"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.criteria.c5"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                    <i class="fas fa-calculator text-indigo-600 mr-2"></i> Matriks Ternormalisasi
                </h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4 rounded-lg overflow-hidden shadow">
                        <thead>
                            <tr class="gradient-bg text-white">
                                <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Alternatif</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C1 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C2 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C3 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C4 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">
                                    C5 <span class="ml-1 px-1.5 py-0.5 bg-green-400 bg-opacity-30 text-white rounded-md">Benefit</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in normalizedData" :key="index">
                                <tr class="hover:bg-gray-50 transition duration-150">
                                    <td class="py-3 px-4 border-b font-medium" x-text="house.name"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.normalized.c1.toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.normalized.c2.toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.normalized.c3.toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.normalized.c4.toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="house.normalized.c5.toFixed(4)"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                    <i class="fas fa-chart-line text-indigo-600 mr-2"></i> Perhitungan Nilai Preferensi
                </h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white mb-4 rounded-lg overflow-hidden shadow">
                        <thead>
                            <tr class="gradient-bg text-white">
                                <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Alternatif</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">C1 × 5</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">C2 × 4</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">C3 × 3</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">C4 × 2</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">C5 × 1</th>
                                <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="(house, index) in finalResults" :key="index">
                                <tr class="hover:bg-gray-50 transition duration-150">
                                    <td class="py-3 px-4 border-b font-medium" x-text="house.name"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="(house.weightedValues.c1).toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="(house.weightedValues.c2).toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="(house.weightedValues.c3).toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="(house.weightedValues.c4).toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center" x-text="(house.weightedValues.c5).toFixed(4)"></td>
                                    <td class="py-3 px-4 border-b text-center font-bold" x-text="house.totalScore.toFixed(4)"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-5 text-right">
                    <button @click="activeTab = 'result'" 
                            class="btn-primary text-white font-medium py-2 px-5 rounded-full focus:outline-none focus:shadow-outline shadow-lg flex items-center ml-auto">
                        <i class="fas fa-trophy mr-2"></i> Lihat Hasil Akhir
                    </button>
                </div>
            </div>
        </div>

        <!-- Result Tab -->
        <div x-show="activeTab === 'result'" x-cloak class="animate__animated animate__fadeIn">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Final Ranking -->
                <div class="glass-card p-6">
                    <div class="flex justify-between items-center mb-5">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-trophy text-indigo-600 mr-2"></i> Hasil Akhir Perangkingan
                        </h2>
                        <div>
                            <div class="flex flex-wrap gap-3">
                                <button @click="exportToPDF()" class="export-btn pdf-gradient text-white py-2.5 px-4 rounded-lg text-sm font-semibold shadow-lg flex items-center">
                                    <i class="fas fa-file-pdf mr-2 btn-icon"></i> Export PDF
                                </button>
                                <button @click="exportToExcel()" class="export-btn excel-gradient text-white py-2.5 px-4 rounded-lg text-sm font-semibold shadow-lg flex items-center">
                                    <i class="fas fa-file-excel mr-2 btn-icon"></i> Export Excel
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full bg-white" id="resultTable">
                            <thead>
                                <tr class="gradient-bg text-white">
                                    <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Ranking</th>
                                    <th class="py-3 px-4 text-left text-xs font-semibold uppercase tracking-wider">Nama Kos</th>
                                    <th class="py-3 px-4 text-center text-xs font-semibold uppercase tracking-wider">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="(house, index) in finalRanking" :key="index">
                                    <tr :class="{'bg-indigo-50 hover-card': index === 0, 'hover:bg-gray-50 transition duration-150': index !== 0}">
                                        <td class="py-3 px-4 border-b">
                                            <span x-show="index === 0" class="inline-flex items-center justify-center w-6 h-6 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full text-white font-bold">1</span>
                                            <span x-show="index === 1" class="inline-flex items-center justify-center w-6 h-6 bg-gradient-to-r from-gray-300 to-gray-400 rounded-full text-white font-bold">2</span>
                                            <span x-show="index === 2" class="inline-flex items-center justify-center w-6 h-6 bg-gradient-to-r from-yellow-700 to-orange-800 rounded-full text-white font-bold">3</span>
                                            <span x-show="index > 2" class="inline-flex items-center justify-center w-6 h-6 bg-gray-200 rounded-full text-gray-700 font-bold" x-text="index + 1"></span>
                                        </td>
                                        <td class="py-3 px-4 border-b font-medium" x-text="house.name"></td>
                                        <td class="py-3 px-4 border-b text-center">
                                            <span class="inline-flex items-center justify-center px-3 py-1 rounded-full" :class="{'bg-indigo-100 text-indigo-800': index === 0, 'bg-gray-100 text-gray-800': index !== 0}">
                                                <span x-text="house.totalScore.toFixed(4)" class="font-bold"></span>
                                            </span>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chart Visualization -->
                <div class="glass-card p-6">
                    <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                        <i class="fas fa-chart-bar text-indigo-600 mr-2"></i> Visualisasi Hasil
                    </h2>
                    <canvas id="resultChart" width="400" height="300" class="rounded-lg shadow"></canvas>
                </div>
            </div>

            <div class="text-center p-6">
                <a href="#" @click.prevent="activeTab = 'input'" class="btn-primary text-white font-medium py-2 px-6 rounded-full focus:outline-none focus:shadow-outline shadow-lg inline-flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i> Kembali ke Input Data
                </a>
            </div>
        </div>

        <!-- About Tab -->
        <div x-show="activeTab === 'about'" x-cloak class="animate__animated animate__fadeIn">
            <div class="glass-card p-6 mb-6">
                <h2 class="text-xl font-bold mb-5 text-gray-800 flex items-center">
                    <i class="fas fa-info-circle text-indigo-600 mr-2"></i> Tentang Metode SAW
                </h2>
                <div class="prose max-w-none">
                    <p class="text-gray-700">Metode <span class="font-semibold text-indigo-600">Simple Additive Weighting (SAW)</span> adalah salah satu metode dalam Sistem Pendukung Keputusan (SPK) yang digunakan untuk menentukan alternatif terbaik dari beberapa alternatif berdasarkan kriteria tertentu.</p>
                    
                    <h3 class="font-bold mt-6 text-gray-800 text-lg">Langkah-langkah Metode SAW:</h3>
                    <ol class="list-decimal list-inside space-y-3 mt-4">
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Menentukan kriteria</span> yang akan digunakan sebagai acuan pengambilan keputusan.
                        </li>
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Menentukan bobot</span> untuk masing-masing kriteria.
                        </li>
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Membuat matriks keputusan</span> berdasarkan kriteria.
                        </li>
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Melakukan normalisasi matriks</span> berdasarkan jenis atribut (benefit atau cost).
                            <ul class="list-disc list-inside ml-5 mt-2">
                                <li>Untuk atribut benefit: <code class="bg-white px-2 py-1 rounded text-indigo-600">r<sub>ij</sub> = x<sub>ij</sub> / max(x<sub>ij</sub>)</code></li>
                                <li>Untuk atribut cost: <code class="bg-white px-2 py-1 rounded text-indigo-600">r<sub>ij</sub> = min(x<sub>ij</sub>) / x<sub>ij</sub></code></li>
                            </ul>
                        </li>
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Menghitung nilai preferensi</span> untuk setiap alternatif dengan mengalikan nilai ternormalisasi dengan bobot kriteria kemudian menjumlahkannya.
                        </li>
                        <li class="bg-indigo-50 p-3 rounded-lg shadow-sm">
                            <span class="font-semibold text-indigo-700">Mengurutkan alternatif</span> berdasarkan nilai preferensi dari tertinggi ke terendah untuk mendapatkan alternatif terbaik.
                        </li>
                    </ol>
                    
                    <h3 class="font-bold mt-6 text-gray-800 text-lg">Kriteria dan Bobot yang Digunakan:</h3>
                    <div class="overflow-x-auto mt-4">
                        <table class="min-w-full bg-white border rounded-lg overflow-hidden shadow">
                            <thead>
                                <tr class="gradient-bg text-white">
                                    <th class="py-3 px-4 text-left">Kriteria</th>
                                    <th class="py-3 px-4 text-center">Bobot</th>
                                    <th class="py-3 px-4 text-center">Jenis</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4 border-b font-medium">Fasilitas (C1)</td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full font-bold">5</span>
                                    </td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full">Benefit</span>
                                    </td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4 border-b font-medium">Harga Sewa (C2)</td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full font-bold">4</span>
                                    </td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full">Cost</span>
                                    </td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4 border-b font-medium">Keamanan (C3)</td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full font-bold">3</span>
                                    </td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full">Benefit</span>
                                    </td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4 border-b font-medium">Kebersihan (C4)</td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full font-bold">2</span>
                                    </td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full">Benefit</span>
                                    </td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4 border-b font-medium">Jarak ke Kampus (C5)</td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full font-bold">1</span>
                                    </td>
                                    <td class="py-3 px-4 border-b text-center">
                                        <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full">Cost</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-6 p-4 border border-indigo-200 rounded-lg bg-indigo-50">
                        <p class="flex items-start">
                            <i class="fas fa-info-circle text-indigo-600 mt-1 mr-2"></i>
                            <span>
                                <strong>Catatan:</strong> Untuk kriteria jenis <span class="text-green-600 font-medium">benefit</span>, semakin tinggi nilainya semakin baik. Untuk kriteria jenis <span class="text-red-600 font-medium">cost</span>, semakin rendah nilainya semakin baik.
                            </span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-4 mt-8 shadow-lg">
        <div class="container mx-auto px-4 text-center">
            <p>Sistem Pendukung Keputusan Pemilihan Kos Terbaik di Sekitar Kampus</p>
            <div class="text-indigo-200 text-sm mt-2 flex justify-center items-center">
                <i class="fas fa-code mr-1"></i> © 2025 - Metode Simple Additive Weighting (SAW)
            </div>
        </div>
    </footer>

    <!-- Script -->
    <script>
        // ...existing code...
        function spkApp() {
            return {
                activeTab: 'input',
                boardingHouses: [],
                normalizedData: [],
                finalResults: [],
                finalRanking: [],
                resultChart: null,
                criteriaChart: null,
                
                // Weights for each criteria
                weights: {
                    c1: 5, // Facility (Benefit)
                    c2: 4, // Rent Price (Cost)
                    c3: 3, // Security (Benefit)
                    c4: 2, // Cleanliness (Benefit)
                    c5: 1  // Distance to Campus (Cost)
                },

                // New boarding house template
                newBoardingHouse: {
                    name: '',
                    criteria: {
                        c1: '',
                        c2: '',
                        c3: '',
                        c4: '',
                        c5: ''
                    }
                },

                // Initialize the app
                init() {
                    // Load data from localStorage if exists
                    const savedData = localStorage.getItem('boardingHouses');
                    if (savedData) {
                        this.boardingHouses = JSON.parse(savedData);
                    }

                    // Watch for changes to save in localStorage
                    this.$watch('boardingHouses', (value) => {
                        localStorage.setItem('boardingHouses', JSON.stringify(value));
                    });
                },

                // Add new boarding house
                addBoardingHouse() {
                    this.boardingHouses.push({
                        name: this.newBoardingHouse.name,
                        criteria: {
                            c1: parseInt(this.newBoardingHouse.criteria.c1),
                            c2: parseInt(this.newBoardingHouse.criteria.c2),
                            c3: parseInt(this.newBoardingHouse.criteria.c3),
                            c4: parseInt(this.newBoardingHouse.criteria.c4),
                            c5: parseInt(this.newBoardingHouse.criteria.c5)
                        }
                    });
                    this.resetForm();
                },

                // Delete boarding house
                deleteBoardingHouse(index) {
                    this.boardingHouses.splice(index, 1);
                },

                // Reset form
                resetForm() {
                    this.newBoardingHouse = {
                        name: '',
                        criteria: {
                            c1: '',
                            c2: '',
                            c3: '',
                            c4: '',
                            c5: ''
                        }
                    };
                },

                // Load default data
                loadDefaultData() {
                    this.boardingHouses = [
                        {
                            name: "Wisma Soedirman",
                            criteria: { c1: 5, c2: 3, c3: 3, c4: 5, c5: 4 }
                        },
                        {
                            name: "Wisma Boy",
                            criteria: { c1: 3, c2: 5, c3: 3, c4: 3, c5: 5 }
                        },
                        {
                            name: "Kos Eka",
                            criteria: { c1: 5, c2: 3, c3: 5, c4: 4, c5: 3 }
                        },
                        {
                            name: "Krikil Kos",
                            criteria: { c1: 3, c2: 4, c3: 4, c4: 3, c5: 4 }
                        },
                        {
                            name: "Kos Yolanda",
                            criteria: { c1: 4, c2: 4, c3: 4, c4: 3, c5: 5 }
                        }
                    ];
                },

                // Calculate using SAW method
                calculateSAW() {
                    // Find max values for each criteria (all are now benefit)
                    let maxC1 = Math.max(...this.boardingHouses.map(h => h.criteria.c1));
                    let maxC2 = Math.max(...this.boardingHouses.map(h => h.criteria.c2));
                    let maxC3 = Math.max(...this.boardingHouses.map(h => h.criteria.c3));
                    let maxC4 = Math.max(...this.boardingHouses.map(h => h.criteria.c4));
                    let maxC5 = Math.max(...this.boardingHouses.map(h => h.criteria.c5));

                    // Calculate normalized matrix
                    this.normalizedData = this.boardingHouses.map(house => {
                        return {
                            name: house.name,
                            normalized: {
                                // For benefit criteria: value / max
                                c1: house.criteria.c1 / maxC1,
                                c2: house.criteria.c2 / maxC2, // Changed from cost to benefit
                                c3: house.criteria.c3 / maxC3,
                                c4: house.criteria.c4 / maxC4,
                                c5: house.criteria.c5 / maxC5, // Changed from cost to benefit
                            }
                        };
                    });

                    // Calculate weighted values and final score
                    this.finalResults = this.normalizedData.map(house => {
                        const weightedValues = {
                            c1: house.normalized.c1 * this.weights.c1,
                            c2: house.normalized.c2 * this.weights.c2,
                            c3: house.normalized.c3 * this.weights.c3,
                            c4: house.normalized.c4 * this.weights.c4,
                            c5: house.normalized.c5 * this.weights.c5
                        };
                        
                        const totalScore = weightedValues.c1 + weightedValues.c2 + weightedValues.c3 + weightedValues.c4 + weightedValues.c5;
                        
                        return {
                            name: house.name,
                            weightedValues: weightedValues,
                            totalScore: totalScore
                        };
                    });

                    // Sort by total score (descending)
                    this.finalRanking = [...this.finalResults].sort((a, b) => b.totalScore - a.totalScore);

                    // Wait for DOM update then create charts
                    this.$nextTick(() => {
                        this.createResultChart();
                        this.createCriteriaChart();
                    });
                },

                // Create bar chart for results
                createResultChart() {
                    const ctx = document.getElementById('resultChart');
                    
                    // Destroy existing chart if it exists
                    if (this.resultChart) {
                        this.resultChart.destroy();
                    }
                    
                    // Create new chart with improved styling
                    this.resultChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: this.finalRanking.map(house => house.name),
                            datasets: [{
                                label: 'Skor Akhir',
                                data: this.finalRanking.map(house => house.totalScore),
                                backgroundColor: [
                                    'rgba(99, 102, 241, 0.8)',
                                    'rgba(129, 140, 248, 0.7)',
                                    'rgba(165, 180, 252, 0.6)',
                                    'rgba(196, 181, 253, 0.5)',
                                    'rgba(216, 180, 254, 0.4)'
                                ],
                                borderColor: [
                                    'rgba(79, 70, 229, 1)',
                                    'rgba(99, 102, 241, 1)',
                                    'rgba(129, 140, 248, 1)',
                                    'rgba(165, 180, 252, 1)',
                                    'rgba(196, 181, 253, 1)'
                                ],
                                borderWidth: 2,
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 15,
                                    grid: {
                                        display: true,
                                        color: 'rgba(0, 0, 0, 0.05)'
                                    }
                                },
                                x: {
                                    grid: {
                                        display: false
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: true,
                                    text: 'Peringkat Kos Berdasarkan Skor SAW',
                                    color: '#1F2937',
                                    font: {
                                        size: 16,
                                        weight: 'bold'
                                    },
                                    padding: {
                                        top: 10,
                                        bottom: 20
                                    }
                                }
                            }
                        }
                    });
                },

                // Export to PDF
                 exportToPDF() {
                    // Using jspdf and jspdf-autotable
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    // Add title
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(18);
                    doc.setTextColor(79, 70, 229);
                    doc.text('Hasil Perangkingan Kos Terbaik', 105, 20, { align: 'center' });
                    
                    // Add subtitle with date
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(12);
                    doc.setTextColor(100, 100, 100);
                    doc.text(`Dihasilkan pada: ${new Date().toLocaleDateString('id-ID')}`, 105, 28, { align: 'center' });

                    // Add horizontal line
                    doc.setDrawColor(79, 70, 229);
                    doc.setLineWidth(0.5);
                    doc.line(20, 32, 190, 32);
                    
                    // Table header style
                    const tableColumn = ["Ranking", "Nama Kos", "Skor"];
                    const tableRows = this.finalRanking.map((house, index) => [
                        index + 1,
                        house.name,
                        house.totalScore.toFixed(4)
                    ]);

                    // Create table
                    doc.autoTable({
                        head: [tableColumn],
                        body: tableRows,
                        startY: 40,
                        theme: 'grid',
                        headStyles: {
                            fillColor: [79, 70, 229],
                            textColor: 255,
                            fontStyle: 'bold',
                            halign: 'center'
                        },
                        columnStyles: {
                            0: { halign: 'center', cellWidth: 25 },
                            2: { halign: 'center', cellWidth: 35 }
                        },
                        alternateRowStyles: {
                            fillColor: [245, 247, 250]
                        },
                        styles: {
                            font: 'helvetica',
                            cellPadding: 6,
                            fontSize: 10
                        },
                        didDrawPage: function(data) {
                            // Footer
                            const pageSize = doc.internal.pageSize;
                            const pageHeight = pageSize.height ? pageSize.height : pageSize.getHeight();
                            doc.setFontSize(8);
                            doc.setTextColor(150, 150, 150);
                            doc.text('SPK Pemilihan Kos Terbaik - Menggunakan Metode SAW', 105, pageHeight - 10, { align: 'center' });
                        }
                    });

                    // Save PDF
                    doc.save(`ranking-kos-${new Date().toISOString().slice(0,10)}.pdf`);
                },

                // Export to Excel (CSV)
                exportToExcel() {
                    // Create CSV content
                    const header = "Ranking,Nama Kos,Skor\n";
                    const rows = this.finalRanking.map((house, index) => 
                        `${index+1},${house.name.replace(/,/g, ' ')},${house.totalScore.toFixed(4)}`
                    );
                    const csvContent = header + rows.join('\n');
                    
                    // Create download link
                    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    
                    link.setAttribute('href', url);
                    link.setAttribute('download', `ranking-kos-${new Date().toISOString().slice(0,10)}.csv`);
                    link.style.display = 'none';
                    
                    // Add to document, trigger download and clean up
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
        }
    </script>
</body>
</html>